<!DOCTYPE doctype PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
  <title>... in Java by Richard G Baldwin</title>
</head>
<body link="#0000ff" vlink="#666666" alink="#ff0000" lang="EN-US">
<h2 align="center">Using Alerts, Images, Timers, and Gauges in MIDlets</h2>
<p><i>Learn how to program an Alert for a MIDlet, add an image to the Alert, add 
a Gauge to the Alert to act as a progress or activity meter, and how to use a 
Timer to control when an Alert becomes visible on the screen.</i></p>
<p><b>Published:</b>&nbsp; March 25. 2008<br>
<b>By <a href="mailto:Baldwin@DickBaldwin.com">Richard G. Baldwin</a></b>
</p>
<p>Java Programming Notes # 2580</p>
<ul>
	<li><a href="#Preface">Preface</a></li>

	<ul>
		<li><a href="#Viewing_tip">Viewing tip</a><ul>
			<li><a href="#Figures">Figures</a></li>
			<li><a href="#Listings">Listings</a></li>
		</ul></li>
		<li><a href="#Supplementary_material">Supplementary material</a></li>
	</ul>
	<li><a href="#General%20Background%20Information">General
	background information</a><ul>
	<li><a href="#The_Alert_class">The Alert class</a></li>
	<li><a href="#The_AlertType_class">The AlertType class</a></li>
	<li><a href="#The_Image_class_">The Image class</a></li>
	<li><a href="#The_Gauge_class_">The Gauge class</a></li>
	<li><a href="#The_Timer_class">The Timer class</a></li>
	<li><a href="#The_TimerTask_class">The TimerTask class</a></li>
</ul>
	</li>
	<li><a href="#Preview">Preview</a></li>
	<li><a href="#Discussion%20and%20Sample%20Programs">Discussion and
	sample code</a></li>
	<ul>
		<li><a href="#The_MIDlet_named_Alert01">The MIDlet named Alert01</a></li>
		<li><a href="#The_MIDlet_named_Alert02">The MIDlet named Alert02</a></li>
	</ul>
	<li><a href="#Run%20the%20program">Run the programs</a></li>
	<li><a href="#Summary">Summary</a></li>
	<li><a href="#Whats%20Next">What's next?</a></li>
	<li><a href="#Resources">Resources</a></li>
	<li><a href="#Complete%20Program%20Listings">Complete program
	listings</a></li>
	<li><a href="#Copyright">Copyright</a></li>
	<li><a href="#About_the_author">About the author</a></li>
</ul>
<hr size="3" width="100%" align="center">
<center>
<h2> <a name="Preface"></a>Preface</h2>
</center>
<p>This is one in a series of tutorial lessons designed to teach you how to 
write programs using the Sun Java Wireless Toolkit for CLDC.&nbsp; The first lesson 
was titled <i>Getting Started with MIDlets and the Sun Java Wireless Toolkit for 
CLDC</i>.&nbsp; The previous lesson was titled <i>Introduction to the MIDlet User 
Interface, Part 2 (see <a href="#Resources">Resources</a>)</i>.</p>
<p><font color="#ff0000"><b>A MIDlet development framework</b></font></p>
<p>For this lesson, you will need the updated version of the MIDlet development 
framework named <b>WTKFramework03</b> that is provided in Listing 13.&nbsp; This 
is a minor update to the framework relative to the previous version, but it is required for the 
MIDlets presented in this lesson that use images.&nbsp; This version preserves 
image files when it is cleaning up after itself.</p>
<p><font color="#FF0000"><b>What you learned in the previous lesson</b></font></p>
<p>In Part 1 and Part 2 of the previous lesson, you learned:</p>
<ul>
	<li>The fundamentals of user interfaces for MIDlets.</li>
	<li>How to instantiate user interface components.</li>
	<li>How to cause user interface components to become visible on the cell 
	phone screen.</li>
	<li>The differences between a <b>Screen</b> and a <b>Display</b>.</li>
	<li>About restrictive constraints and modifier flags.</li>
	<li>About the MIDlet user interface class hierarchy.</li>
	<li>About the methods of various classes that can be used to manipulate 
	user input and output.</li>
	<li>How to program MIDlet user interfaces that minimize the MIDlet's memory 
	footprint while the MIDlet is paused making consistent use of the MIDlet 
	class methods to satisfy the life-cycle requirements for MIDlets.</li>
</ul>
<p><font color="#FF0000"><b>What you will learn in this lesson</b></font></p>
<p>In this lesson you will learn:</p>
<ul>
	<li>How to program an <b>Alert</b> for a MIDlet.</li>
	<li>How to add an image to the <b>Alert</b>.</li>
	<li>How to add a <b>Gauge</b> to the <b>Alert</b> to act as a progress 
	or activity meter.</li>
	<li>How to use a <b>Timer</b> to control when an <b>Alert</b> becomes 
	visible on the screen.</li>
</ul>
<h3> <a name="Viewing_tip">Viewing tip</a></h3>
<p> I recommend that you open another copy of this document in a separate 
browser window and use the following links to easily find and view the figures 
and listings while you are reading about them.</p>
<h4> <a name="Figures">Figures</a></h4>
<ul>
	<li><a href="#Figure_1">Figure 1</a>. Partial class hierarchy for MIDP 2.0.</li>
	<li><a href="#Figure_2">Figure 2</a>. Sun cell phone emulator display of 
	MIDlet named Alert01.</li>
	<li><a href="#Figure_3">Figure 3</a>. Sun cell phone emulator display of 
	MIDlet named Alert02.</li>
	<li><a href="#Figure_4">Figure 4</a>. Selected methods of the Alert class as 
	of MIDP 2.0.</li>
	<li><a href="#Figure_5">Figure 5</a>. Methods of the TimerTask class as of 
	MIDP 2.0.</li>
</ul>
<h4> <a name="Listings">Listings</a></h4>
<ul>
	<li><a href="#Listing_1">Listing 1</a>. Beginning of the MIDlet class named 
	Alert01.</li>
	<li><a href="#Listing_2">Listing 2</a>. Beginning of the startApp method in 
	Alert01.</li>
	<li><a href="#Listing_3">Listing 3</a>. Schedule a TimerTask.</li>
	<li><a href="#Listing_4">Listing 4</a>. Remaining code in startApp method in 
	Alert01.</li>
	<li><a href="#Listing_5">Listing 5</a>. The pauseApp and destroyApp methods 
	in Alert01.</li>
	<li><a href="#Listing_6">Listing 6</a>. Beginning of the class named MyTimerTask in Alert01.</li>
	<li><a href="#Listing_7">Listing 7</a>. Create and program an Alert object 
	in Alert01.</li>
	<li><a href="#Listing_8">Listing 8</a>. Create and service the Gauge in 
	Alert01.</li>
	<li><a href="#Listing_9">Listing 9</a>. Make the Alert visible in the MIDlet 
	named Alert01.</li>
	<li><a href="#Listing_10">Listing 10</a>. Create an Alert object for the 
	MIDlet named Alert02.</li>
	<li><a href="#Listing_11">Listing 11</a>. Create a Gauge for the MIDlet 
	named Alert02.</li>
	<li><a href="#Listing_12">Listing 12</a>. Set the current value of the Gauge 
	to be count mod 3.</li>
	<li><a href="#Listing_13">Listing 13</a>. The updated MIDlet development 
	framework named WTKFramework03.</li>
	<li><a href="#Listing_14">Listing 14</a>. Source code for the MIDlet named 
	Alert01.</li>
	<li><a href="#Listing_15">Listing 15</a>. Source code for the MIDlet named 
	Alert02.</li>
</ul>
<h3 align="left"> <a name="Supplementary_material">Supplementary material</a></h3>
<p> I recommend that you also study the other lessons in my extensive collection 
of online Java tutorials.&nbsp; You will find a consolidated index at
<font
 color="#000000"> <a href="http://www.dickbaldwin.com/toc.htm">
www.DickBaldwin.com</a>.</font></p>
<h2 align="center"><font color="#000000"> <a
 name="General Background Information">General background information</a></font></h2>
<p><font color="#FF0000"><b>A partial class hierarchy</b></font></p>
<p>In the earlier lesson titled <i>Introduction to the MIDlet User Interface, 
Part 1 (see <a href="#Resources">Resources</a>)</i>, I presented a partial class 
hierarchy for MIDP 2.0.&nbsp; Figure 1 shows an expanded version of that class hierarchy. </p>












<p>
 <b><a name="Figure_1">Figure 1</a>. Partial class hierarchy for MIDP 2.0.</b><table border="1" cols="1" width="477" bgcolor="#ffffff">
  <tbody>
    <tr>
      <td>
<ul>
	<li>Object<ul>
		<li><i><b>Displayable</b></i><ul>
			<li><i><b>Screen</b></i><ul>

				<li><i><b>TextBox</b></i></li>
				<li><b>Alert</b></li>
				<li>Form</li>
				<li>List</li>
			</ul>
			</li>
			<li>Canvas <i>(abstract)</i><ul>

				<li>GameCanvas <i>(abstract)</i></li>
			</ul>
			</li>
		</ul>
		</li>
		<li><i><b>Display</b></i></li>
		<li><b><i>Ticker</i></b></li>
		<li><b>AlertType</b></li>
		<li><b>Image</b></li>
		<li>Item<ul>
		<li><b>Gauge</b></li>
		<li>TextField</li>
	</ul>

		</li>
		<li><b>Timer</b></li>
		<li><b>TimerTask</b></li>
	</ul>

	</li>
</ul></td>
    </tr>
  </tbody>
</table>
</p>
<p>I discussed and explained the classes shown in bold Italics in earlier lessons.&nbsp;
<a name="I_will_discuss_and_explain_the_classes">I 
will discuss and explain the classes</a> shown in boldface <i>(non Italics)</i> in this lesson.&nbsp; I will discuss 
the remainder of the classes shown in Figure 1 <i>(plus other classes)</i> in future lessons.</p>
<p><font color="#FF0000"><b>The Alert class</b></font></p>
<p>You may recall from the earlier lessons that an object of the class <b>Alert</b> 
is one of four types of high-level user interface <i>(UI)</i> components that 
you can place on the cell phone screen to communicate with the user.&nbsp; The 
four high-level UI component classes are all subclasses of the <b>Screen</b> class 
shown in Figure 1.</p>
<p><font color="#FF0000"><b>A temporary screen display</b></font></p>
<p>An <b>Alert</b> is a <b>Screen</b> that takes over the cell phone display and 
shows some data for a specified time period.&nbsp; Then it disappears and the 
display reverts to the <b>Screen</b> that would normally be showing.&nbsp; The 
contents of the <b>Alert</b> on the screen can include a title, a string, an 
image, and a <b>Gauge</b>.</p>
<p><font color="#FF0000"><b>An AlertType</b></font></p>
<p>An <b>Alert</b> may optionally have an <b>AlertType</b> associated with it to 
indicate the nature of the alert. <i>(If you pass null to the corresponding 
constructor parameter, there is no alert type associated with the alert.)</i>&nbsp; The cell 
phone can use the <b>AlertType </b> value to play an appropriate sound when the <b>Alert</b> is 
displayed.&nbsp; According to Sun,</p>
<blockquote>
	<p><i>&quot;The actual sound made by the device, if any, is determined by the 
	device. The device may ignore the request, use the same sound for several 
	AlertTypes or use any other means suitable to alert the user.&quot;</i></p>
</blockquote>
<p><font color="#FF0000"><b>An Image</b></font></p>
<p>As mentioned above, an <b>Alert</b> can contain an <b>Image</b> in addition 
to the title, the string, and the <b>Gauge</b>.&nbsp; The <b>Image</b> data can 
come from a variety of sources including graphics files of types gif,
<a href="#PNG">png</a>, 
and jpeg.&nbsp; At least that is true with regard to the Sun cell phone 
emulator.</p>
<p>In general, an <b>Image</b> used with a MIDlet can be either mutable or 
immutable.&nbsp; In this lesson, we will confine the discussion to 
immutable images only.</p>
<p><font color="#FF0000"><b>A Gauge</b></font></p>
<p>Optionally, an <b>Alert</b> can contain a <b>Gauge</b> object.&nbsp; The<b> 
Gauge</b> object must be operating in a non-interactive manner and must comply 
with some other <a href="#must_satisfy_the_following_restrictions">restrictions</a> as well.&nbsp; One use for a<b> Gauge </b>
object that meets all of the restrictions is as an activity or progress 
indicator.</p>
<p><font color="#FF0000"><b>Sample screen shots</b></font></p>
<p>Figure 2 and Figure 3 show the Sun cell phone emulator output for the MIDlets 
named <b>Alert01</b> and <b>Alert02.</b></p>
<p>
 <b><a name="Figure_2">Figure 2</a>. Sun cell phone emulator display of MIDlet 
	named Alert01.</b><table border="0" cols="1" bgcolor="#ffffff">
  <tbody>
    <tr>
      <td>
      <pre><img border="1" src="java2580a1.jpg" width="312" height="380"></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Explanation of the screen shots</b></font></p>
<p>In both images, the <b>Alert</b> title is shown in the gray bar across the 
top.&nbsp; The text string portion of the alert is on the left side of the cell 
phone screen slightly below the center.&nbsp; The red and blue balls are the 
images.&nbsp; The vertical bars in Figure 2 constitute the gauge in that MIDlet.&nbsp; 
The image of Duke in Figure 3 is one of three successive images of Duke that 
constitute the gauge in that MIDlet.&nbsp; I will explain the differences between 
these two MIDlets later.</p>
<p>
 <b><a name="Figure_3">Figure 3</a>. Sun cell phone emulator display of MIDlet 
	named Alert02.</b><table border="0" cols="1" bgcolor="#ffffff">
  <tbody>
    <tr>
      <td>
      <pre><img border="1" src="java2580a2.jpg" width="314" height="377"></pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Missing screen shots</b></font></p>
<p>When the <b>Alerts</b> are not showing on the cell phone screens in the two 
sample MIDlets in this lesson, a <b>TextBox</b> screen is showing.&nbsp; 
However, because the behavior of each MIDlet is dynamic and the <b>TextBox</b> 
screen doesn't stay on the display very long, I was unable to capture a screen 
shot of the <b>TextBox</b> screen.</p>
<p>This shouldn't be a problem, however.&nbsp; You have seen screen shots of <b>
TextBox</b> objects before.&nbsp; The <b>TextBox</b> screens in these MIDlets 
look very much like the screen shown in Figure 1 of the earlier lesson titled <i>
Introduction to the MIDlet User Interface, Part 1 (see <a href="#Resources">
Resources</a>)</i>.</p>
<h3><a name="The_Alert_class">The Alert class</a></h3>
<p><font color="#FF0000"><b><a name="The_constructor_for_the_Alert_class">The 
constructor for the Alert class</a></b></font></p>
<p>As of MIDP 2.0, there are two overloaded constructors for the <b>Alert</b> 
class.&nbsp; The constructor that I will use in this lesson
<a name="takes_four_parameters:">takes four parameters:</a></p>
<ul>
	<li>String&nbsp;title</li>
	<li>String&nbsp;alertText</li>
	<li>Image&nbsp;alertImage</li>
	<li>AlertType&nbsp;alertType</li>
</ul>
<p>The first three of the parameters match three items in Figure 2 and Figure 3.&nbsp; 
However, as near as I can tell, the fourth parameter <i>(alertType)</i> doesn't 
have a visible manifestation in the Sun cell phone emulator.&nbsp; I will 
explain the audio manifestation of this parameter later when I explain the code.</p>
<p>The other overloaded constructor takes only two parameters and they match the 
first two parameters in the above <a href="#takes_four_parameters:">list</a>.</p>
<p><font color="#FF0000"><b>Methods of the Alert class</b></font></p>
<p>As of MIDP 2.0, the <b>Alert</b> class defines fourteen methods.&nbsp; Three 
of those methods are associated with interactive programming and commands, which I will be discussing in a future lesson.&nbsp; Six of the methods are 
relatively standard <i>getter</i> methods, which should not require any 
explanation or discussion.&nbsp; The remaining five methods are shown in Figure 4.</p>
<p>
 <b><a name="Figure_4">Figure 4</a>. Selected methods of the Alert class as of MIDP 2.0. </b>
<table border="1" cols="1" width="477" bgcolor="#ffffff">
  <tbody>
    <tr>
      <td>
<ul>
	<li><b>setImage(Image&nbsp;img)</b> - Sets the Image used in the Alert.</li>
	<li><b>setIndicator(Gauge&nbsp;indicator)</b> - &nbsp;Sets an activity indicator on 
	this Alert.</li>
	<li><b>setString(String&nbsp;str)</b> - Sets the text string used in the Alert.</li>
	<li><b>setTimeout(int&nbsp;time)</b> - Set the time for which the Alert is to be 
	shown.</li>
	<li><b>setType(AlertType&nbsp;type)</b> - Sets the type of the Alert.</li>
</ul>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Methods that I did or could have used</b></font></p>
<p>These are methods that I either did use, or could have used in the two sample 
MIDlets in this lesson.&nbsp; By this I mean that these are methods that 
I could have used to set the important properties of the <b>Alert</b> objects had 
I not elected to specify these property values using constructor parameters.&nbsp; 
Note, however that the <b>setIndicator</b> method does not have a constructor 
parameter counterpart and the method must be called to attach a <b>Gauge</b> to 
the <b>Alert</b>.</p>
<p>The six getter methods that I didn't list above can be used to get the 
current values of the same five properties as the setter methods in Figure 4, 
plus an additional property named <b>defaultTimeout</b>.</p>
<h3><a name="The_AlertType_class">The AlertType class</a></h3>
<p>An object of the <b>AlertType</b> class can be passed as the fourth parameter 
to the <b>Alert</b> <a href="#The_constructor_for_the_Alert_class">constructor</a> 
to establish the type of the <b>Alert</b>.&nbsp; Optionally, a value of null can 
be passed meaning that the <b>Alert</b> is of no specific type.</p>
<p><font color="#FF0000"><b>Five types of alerts</b></font></p>
<p><b>Alert</b> objects may be used by a MIDlet to present various kinds of 
information to the user.&nbsp; The <b>AlertType</b> object can be used to cause 
the type of the alert to be more specific.&nbsp;
<a name="The_predefined_types_in_MIDP_2.0_are:">The predefined types in MIDP 2.0 
are:</a></p>
<ul>
	<li>INFO</li>
	<li>WARNING</li>
	<li>ERROR</li>
	<li>ALARM</li>
	<li>CONFIRMATION</li>
</ul>
<p>One of the sample MIDlets in this lesson uses an alert of type ALARM.&nbsp; 
The other uses an alert of type CONFIRMATION.</p>
<p><font color="#FF0000"><b>Playing AlertType sounds without changing the 
display</b></font></p>
<p>Although this capability is not demonstrated by either of the sample MIDlets 
in this lesson, according to Sun,</p>
<blockquote>
	<p><i>&quot;An AlertType may be used to directly signal the user without changing 
	the current Displayable. The <a name="playSound">playSound</a> method can be 
	used to spontaneously generate a sound to alert the user. For example, a 
	game using a Canvas can use playSound to indicate success or progress.&quot;</i></p>
</blockquote>
<p><font color="#FF0000"><b>A very simple class</b></font></p>
<p>The <b>AlertType</b> class is a very simple class.&nbsp; It defines a public 
static final variable for each of the five alert types in the above
<a href="#The_predefined_types_in_MIDP_2.0_are:">list</a>.&nbsp; It defines one 
constructor that takes no parameters, and it defines the <b>playSound</b> method 
mentioned <a href="#playSound">above</a>.&nbsp; That's about all there is to the 
<b>AlertType</b> class.</p>
<h3><a name="The_Image_class_">The Image class</a></h3>
<p>An object of the <b>Image</b> class is used to hold graphical image data.&nbsp; 
Images can be placed within <b>Alert</b>, <b>Choice</b>, <b>Form</b>, or <b>
ImageItem</b> objects.&nbsp; In this lesson, we will be concerned only with 
placing <b>Image</b> objects in <b>Alert</b> objects.&nbsp; I will discuss and 
explain the other types of objects in future lessons.</p>
<p><font color="#FF0000"><b>Mutable or immutable</b></font></p>
<p>Images may be either <i>mutable</i> or <i>immutable</i> depending upon how 
they are created. Immutable images are usually created by loading image data 
from various resources such as image files.&nbsp; Once they have been created, 
they cannot be modified.</p>
<p>Mutable images are created as blank images containing only white pixels.&nbsp; 
They may be modified after they are created.&nbsp; In this lesson, we will be 
concerned only with immutable images.&nbsp; I will discuss mutable images in a 
future lesson on graphics and the <b>Canvas</b> class.</p>
<p><font color="#FF0000"><b>Image file formats</b></font></p>
<p>The Sun documentation for the <b>Image</b> class would lead one to believe 
that only image files of type <a name="PNG">PNG</a> are supported.&nbsp; However, I have confirmed 
experimentally that at least when using the Sun cell phone emulator, the sample 
MIDlets in this lesson will also work properly with GIF image files and JPEG image 
files in addition to PNG image files.&nbsp; 
In any event, there is a link in <a href="#Resources">Resources</a> to a free 
online image file conversion service that can be used to convert numerous image 
file formats to PNG format if you want to stick strictly with PNG image files.</p>
<p><font color="#FF0000"><b>No constructor and no fields</b></font></p>
<p>The <b>Image</b> class has no public constructor and no fields.&nbsp; What it 
does have is a set of six public static overloaded methods named <b>createImage</b> 
that can be called to create an object of type <b>Image</b>.&nbsp; In addition, 
there is a public static method named <b>createRGBImage</b> that can also be 
called to create an object of type <b>Image</b>.</p>
<p>Each of these methods lets you specify the source of the image data in a 
different way.&nbsp; I will use only one of the overloaded methods in this 
lesson.&nbsp; The version of the <b>createImage</b> method that I will use 
accepts the path and name of an image file <i>(png, gif, or jpeg)</i> and uses the image data in that file to produce the <b>Image</b> object.</p>
<p><font color="#FF0000"><b>Five additional methods</b></font></p>
<p>In addition to the overloaded methods mentioned above, the <b>Image</b> class 
defines five additional methods, most of which are probably most useful when 
dealing with graphics and the <b>Canvas</b> class.</p>
<h3><a name="The_Gauge_class_">The Gauge class</a></h3>
<p>According to Sun, the <b>Gauge</b> class</p>
<blockquote>
	<p>&quot;Implements a graphical display, such as a bar graph, of an integer 
	value.&quot;</p>
</blockquote>
<p>The vertical bars in Figure 2 and the image of Duke in Figure 3 are two 
different 
manifestations of a <b>Gauge</b> object.</p>
<p><font color="#FF0000"><b>The Gauge constructor</b></font></p>
<p>The <b>Gauge</b> class has a single constructor that requires the following 
parameters:</p>
<ul>
	<li>String&nbsp;label</li>
	<li>boolean&nbsp;interactive</li>
	<li>int&nbsp;maxValue</li>
	<li>int&nbsp;initialValue</li>
</ul>
<p>The first parameter is used to create a label for the <b>Gauge</b>.&nbsp; The second parameter specifies 
whether or not the <b>Gauge</b> is interactive.&nbsp; For example, an 
interactive <b>Gauge</b> could be used as an interactive volume control.</p>
<p><font color="#FF0000"><b>A graphical representation of numeric values</b></font></p>
<p>The purpose of a <b>Gauge</b> is to provide a graphical representation of 
integer values between zero and a maximum value specified by the third parameter 
to the constructor.&nbsp; The fourth parameter specifies the initial value that 
will be graphed.</p>
<p>At any point in time, the <b>Gauge</b> object contains a <i>current value</i>.&nbsp; 
That value must lie between zero and the specified maximum value, inclusive.&nbsp; 
Otherwise, the MIDlet will throw a runtime exception.</p>
<p>The maximum value and the current value are within the control of the 
MIDlet code.&nbsp; However, the display provided by the cell phone may be more granular than 
the data.&nbsp; In that case, a given display may represent more than one 
current value.</p>
<p><font color="#FF0000"><b>Restrictions for Gauge objects with Alerts</b></font></p>
<p>When a <b>Gauge</b> object is used as a progress or activity indicator for an
<b>Alert</b>, it <a name="must_satisfy_the_following_restrictions">must satisfy the following restrictions</a>:</p>
<ol>
	<li>It must not be interactive.</li>
	<li>It must not be owned by another container <i>(Alert or Form)</i>.</li>
	<li>It must not have any Commands.</li>
	<li>It must not have an ItemCommandListener.</li>
	<li>It must not have a label <i>(that is, its label must be null)</i>.</li>
	<li>Its preferred width and height must both be unlocked.</li>
	<li>Its layout value must be LAYOUT_DEFAULT.</li>
</ol>
<p>The <b>Gauge</b> objects that I will use with the sample MIDlets in 
this lesson will satisfy those requirements.</p>
<p><font color="#FF0000"><b>A non-interactive Gauge</b></font></p>
<p>The <b>Gauge </b>objects will be used in non-interactive mode in the sample 
MIDlets in this lesson.&nbsp; <i>(I plan to illustrate 
the use of an interactive <b>Gauge</b> in a future lesson.)</i>&nbsp; 
The non-interactive mode will be used in the sample MIDlets to 
provide progress or activity feedback to the user.</p>
<p><font color="#FF0000"><b>Progress and activity indicators</b></font></p>
<p>In the MIDlet shown in 
Figure 2, the <b>Gauge</b> object is used to show progress toward a specific 
goal <i>(six bars)</i>.&nbsp; In the MIDlet shown in Figure 3, the <b>Gauge</b> is used to show that the 
process is active, but there is no indication of percent of completion.&nbsp; In 
this case, the <b>Gauge</b> is represented by Duke cycling among three different 
images.</p>
<p><font color="#FF0000"><b>A definite or indefinite range</b></font></p>
<p>A non-interactive <b>Gauge</b> can have a definite or indefinite range, and 
this is where things get a little more complicated. For the easy case where a <b>
Gauge</b> has definite range, it will have current value between zero and the 
maximum value set by the application, inclusive. The implementation will provide 
a graphical representation of this value similar to that shown in Figure 2.</p>
<p><font color="#FF0000"><b>Four states for an indefinite range</b></font></p>
<p>According to Sun, a non-interactive <b>Gauge</b> that has indefinite range 
will exist in <a name="one_of_four_states">one of four states</a>: </p>
<ul>
	<li>CONTINUOUS_IDLE</li>
	<li>INCREMENTAL_IDLE</li>
	<li>CONTINUOUS_RUNNING</li>
	<li>INCREMENTAL_UPDATING</li>
</ul>
<p>These states are intended to indicate to the user that some level of activity 
is occurring.</p>
<p>The <i>incremental-updating</i> state can be used to indicate that progress is being 
made even though there is no known endpoint to the activity.&nbsp; For example, 
the MIDlet may be loading a file of an unknown size.</p>
<p>The <i>continuous-running</i> state can be used to indicate simply that the process 
is busy with no specific indication of progress, indefinite or otherwise.</p>
<p>The c<i>ontinuous-idle</i> and <i>incremental-idle</i> states can be used to indicate that 
no activity is occurring.</p>
<p><font color="#FF0000"><b>Methods of the Gauge class</b></font></p>
<p>As of MIDP 2.0, the <b>Gauge</b> class defines eleven methods.&nbsp; However, 
primarily because of the restricted nature of a <b>Gauge</b> that is attached to 
an <b>Alert</b>, the sample MIDlets in this lesson use only one of the eleven 
methods: <b>setValue</b>.&nbsp; As you will see later, this method is used to 
set the current value of the <b>Gauge</b> each time the <b>Alert</b> is 
displayed.</p>
<h3><a name="The_Timer_class">The Timer class</a></h3>
<p>An object of the <b>Timer</b> class has no special relationship with the
<b>Alert</b> class.&nbsp; You may recall that in previous tutorials I have 
launched a<b> Worker</b> thread to do the work of a MIDlet and have launched a
<b>Toggler</b> thread to control timing and to exercise the MIDlet.&nbsp; An object of 
the <b>Timer</b> class along with an associated object of the <b>TimerTask</b> 
class provides a quick and easy way to accomplish the same 
thing if the requirements aren't too demanding.</p>
<p>According to Sun, a <b>Timer</b> object provides:</p>
<blockquote>
	<p><i>&quot;A facility for threads to schedule tasks for future execution in a 
	background thread. Tasks may be scheduled for one-time execution, or for 
	repeated execution at regular intervals.&quot;</i></p>
</blockquote>
<p><font color="#FF0000"><b>How does it work?</b></font></p>
<p>Basically, you instantiate an object of the <b>Timer</b> class to control the 
timing.&nbsp; Then you use that object to schedule the <b>run</b> method of an 
object of the <b>TimerTask</b> class to be executed either once at some 
specified time in the future, or repeatedly with a specified repetition rate 
beginning at some specified time in the future.</p>
<p><font color="#FF0000"><b>A relatively simple class</b></font></p>
<p>The <b>Timer</b> class is a relatively simple class.&nbsp; As of MIDP 2.0 it 
has a single constructor that takes no parameters and seven methods.&nbsp; One 
of the methods is a <b>cancel</b> method that terminates the timer discarding 
any currently scheduled tasks.</p>
<p>The other six methods are overloaded <b>schedule</b> methods or overloaded <b>
scheduleAtFixedRate</b> methods.&nbsp; As the names imply, all of these methods 
are used to schedule future tasks and the overloaded versions simply provide 
different ways to do that.&nbsp; Regardless of which method you use, you will 
need an object of the <b>TimerTask</b> class.&nbsp; That brings us to the next topic.</p>
<h3><a name="The_TimerTask_class">The TimerTask class</a></h3>
<p>The <b>TimerTask</b> class has a single constructor that takes no parameters 
along with the three methods shown in Figure 5.</p>
<p>
 <b><a name="Figure_5">Figure 5</a>. Methods of the TimerTask class as of MIDP 
	2.0. </b>
<table border="1" cols="1" width="477" bgcolor="#ffffff">
  <tbody>
    <tr>
      <td>
<ul>
	<li><b>cancel()</b> - Cancels this timer task.</li>
	<li><b>run()</b> - The action to be performed by this timer task.</li>
	<li><b>scheduledExecutionTime()</b> - Returns the scheduled execution time 
	of the most recent actual execution of this task</li>
</ul>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The names and the brief descriptions of the methods in Figure 5 are self-explanatory.&nbsp; We will be primarily interested in the abstract <b>run</b> 
method.&nbsp; We will extend the <b>TimerTask</b> class into a new class and 
override the <b>run</b> method to cause it to perform the desired action at the 
scheduled points in time.</p>
<p>That concludes the discussion and explanation of the boldface <i>(non Italic)</i> 
classes shown in Figure 1 that I promised
<a href="#I_will_discuss_and_explain_the_classes">earlier</a>.&nbsp; Now its 
time to examine the code that puts these classes to work.</p>
<h2 align="center"><font color="#000000"><a name="Preview">Preview</a></font></h2>
<p>In the remainder of this lesson, I will present and explain two MIDlets named
<b>Alert01</b> and <b>Alert02</b>.&nbsp; The primary differences between the two 
will be in the areas of alert type and <b>Gauge</b> mode.</p>
<center>
<h2> <a name="Discussion and Sample Programs"></a><font color="#000000">Discussion
and sample code</font></h2>
</center>
<table align="right" border="0" cellpadding="0" cellspacing="0" width="275">
	<tr>
		<td width="10">&nbsp;</td>
		<td>
		<table border="1" cellpadding="5" cellspacing="0" width="100%">
			<tr>
				<td bgcolor="#eeeeee"><b>MIDlet testing</b><br>
				The MIDlets in this lesson were tested using a Java SE 6 
				compiler, targeted at a V1.4 virtual machine, and WTK 2.5.2 
				running under Windows XP.
				</td>
			</tr>
		</table>
		</td>
	</tr>
</table>
<h3><a name="The_MIDlet_named_Alert01">The MIDlet named Alert01</a></h3>
<p>The purpose of this MIDlet is to illustrate:</p>
<ul>
	<li>The use of an <b>Alert</b> user interface object.</li>
	<li>The use of image files in conjunction with the <b>Alert</b>.</li>
	<li>The use of a <b>Timer</b> to schedule the <b>Alert</b> for repeatedly 
	becoming visible.</li>
	<li>The use of a non-interactive <b>Gauge</b> as a <i><b>progress meter</b></i>.</li>
</ul>
<p>Each time the <b>Alert</b> becomes visible, it obscures a <b>TextBox</b> 
object that is also being displayed by the MIDlet.&nbsp; When the <b>Alert</b> 
disappears, the <b>TextBox</b> reappears.</p>
<p><font color="#FF0000"><b>Requirements</b></font></p>
<p>This MIDlet requires:</p>
<ul>
	<li>The use of the newly updated MIDlet development framework named W<b>TKFramework03.</b></li>
	<li>An image file named <b><a name="redball.PNG">redball.PNG</a></b> in the 
	source code directory.</li>
	<li>An image file named <b>blueball.PNG</b> in the source code directory.</li>
</ul>
<p><font color="#FF0000"><b>Image files</b></font></p>
<p>You can substitute any image files containing small images for the two image 
files listed <a href="#redball.PNG">above</a>.&nbsp; You will have to make the 
names of your image files match the references to the image files in the code.&nbsp; 
Remember that file names referred to by Java code are case sensitive.&nbsp; The case of the reference to the image files in the code must 
match the actual case of the characters in the image file names.</p>
<p>The MIDlet will run properly in Sun's cell phone emulator for PNG, GIF, and 
JPEG image files so long as they are in the directory with the source code and 
they are properly referenced in the code.&nbsp; This restriction on location is 
imposed by the framework program named <b>WTKFramework03</b> and is not imposed 
by MIDlet technology in general.</p>
<p><font color="#FF0000"><b>The alert type</b></font></p>
<p>This MIDlet uses an alert of type <b>ALARM</b>.&nbsp; This results n an 
audible alert that sounds like a telephone ringing when the MIDlet is run in the 
Sun cell phone emulator.</p>
<p><font color="#FF0000"><b>Different images are displayed</b></font></p>
<p>Each time the <b>Alert</b> becomes visible, it displays either a red ball or 
a blue ball, depending on whether the time in seconds is even or odd.&nbsp; A 
red ball is displayed for even values of time and a blue ball is displayed for 
odd values of time.</p>
<p><font color="#FF0000"><b>The Gauge</b></font></p>
<p>A <b>Gauge</b> is displayed with a definite range of zero to six bars as 
shown in Figure 2.&nbsp; A new bar changes from white to gray each time the <b>
Alert</b> becomes visible.</p>
<p><font color="#FF0000"><b>Will discuss in fragments</b></font></p>
<p>As usual, I will discuss and explain this MIDlet in fragments.&nbsp; A 
complete listing of the MIDlet is provided in Listing 14.</p>
<p>The beginning of the MIDlet class named <b>Alert01</b> including the 
constructor is shown in Listing 1.</p>
<p>
<b><a name="Listing_1">Listing 1</a>. Beginning of the MIDlet class named 
Alert01. </b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>public class <b>Alert01</b> extends MIDlet{
  Alert01 theMidlet;
  Image image;
  int count = 0;
  long baseTime;
  
  public Alert01(){
    System.out.println("Construct MIDlet");
    theMidlet = this;
    baseTime = new Date().getTime()/1000;
  }//end constructor</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The <b>baseTime</b> variable is populated with the number of seconds that 
have elapsed since January 1, 1970.&nbsp; This value will be used to compute 
elapsed time since the MIDlet started running at several locations in the 
MIDlet.&nbsp; Otherwise, the code in Listing 1 is straightforward and shouldn't 
require further explanation.</p>
<p><font color="#FF0000">
<b>Beginning of the startApp method in Alert01</b></font></p>
<p>The <b>startApp</b> method begins in Listing 2.&nbsp; Recall that this method 
is called by the Application Management Software <i>(AMS)</i> to cause the 
MIDlet to transition from the paused state to the active state.&nbsp; The MIDlet 
begins in the paused state when it is launched and constructed.&nbsp; Then the 
AMS calls the <b>startApp</b> method to cause the MIDlet to enter the paused 
state.</p>
<p>
<b><a name="Listing_2">Listing 2</a>. Beginning of the startApp method in 
Alert01. </b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>  public void <b>startApp</b>(){
    System.out.println("Create and display a TextBox");

    TextBox textBox = new TextBox("TextBox Title",
                                  "TextBox contents",
                                  50,//width
                                  TextField.ANY);
                                  
    //Make the TextBox the current Displayable object.
    Display.getDisplay(this).setCurrent(textBox);</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000"><b>Create a TextBox and make it visible</b></font></p>
<p>The code in Listing 2 creates a <b>TextBox</b> object and causes it to be the
<i>current</i> <b>Displayable</b> object.&nbsp; The <b>TextBox</b> will be 
visible any time that the <b>Alert</b> is not visible.</p>
<p><font color="#FF0000">
<b>Schedule a TimerTask</b></font></p>
<p>Listing 3 creates and schedules a <b>TimerTask</b> that will display and 
sound an alert repeatedly.&nbsp; The <b>Alert</b> first appears at two seconds
<i>(2000 milliseconds)</i> in the future and repeats every three seconds <i>
(3000 milliseconds)</i>.</p>
<p>
<b><a name="Listing_3">Listing 3</a>. Schedule a TimerTask.</b><table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>    Timer myTimer = new Timer();
    myTimer.schedule(new MyTimerTask(),2000,3000);</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p><font color="#FF0000">
<b>Remaining code in startApp method in Alert01</b></font></p>
<p>Then the <b>startApp</b> method sleeps for twenty seconds, following which it 
cancels the <b>TimerTask</b> and calls the <b>destroyApp</b> method to cause the 
MIDlet to transition to the destroyed state.</p>
<p>
<b><a name="Listing_4">Listing 4</a>. Remaining code in startApp method in 
Alert01. </b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>    //Sleep for 20 seconds.
    try{Thread.currentThread().sleep(20000);
    } catch(Exception e){}
    
    //Cancel the timer.
    myTimer.cancel();

    //Enter the destroyed state.
    this.destroyApp(true);
  }//end startApp</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The <b>Alert</b> will be displayed several times on a different thread during 
the twenty seconds that the thread containing the <b>startApp</b> method is 
sleeping.</p>
<p><font color="#FF0000">
<b>The pauseApp and destroyApp methods in Alert01</b></font></p>
<p>The <b>pauseApp</b> and <b>destroyApp</b> methods are shown in Listing 5.</p>
<p>
<b><a name="Listing_5">Listing 5</a>. The pauseApp and destroyApp methods in 
Alert01. </b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>  public void <b>pauseApp</b>(){
  }//end pauseApp

  public void <b>destroyApp</b>(boolean unconditional){
    System.out.println("Destroy MIDlet");
    notifyDestroyed();
  }//end destroyApp</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>For the sake of simplicity, this MIDlet makes no provisions for dealing with 
the possibility that the <b>pauseApp</b> method might be called by the AMS.&nbsp; 
Therefore, the <b>pauseApp</b> method is empty.</p>
<p>The <b>destroyApp</b> method displays a terminating message on the standard 
output device and calls the <b>notifyDestroyed</b> method to signal to the AMS 
that the MIDlet is entering the destroyed state.</p>
<p><font color="#FF0000"><b>Beginning of the MyTimerTask class</b></font></p>
<p>Listing 6 shows the beginning of the class named <b>MyTimerTask</b>, which 
extends the class named <b>TimerTask</b> including the beginning of the 
overridden <b>run</b> method.&nbsp; The <b>run</b> method in an object of this 
class is scheduled to run repeatedly by the code in Listing 3.</p>
<p>
<b><a name="Listing_6">Listing 6</a>. Beginning of the class named MyTimerTask in Alert01.</b><table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>  class <b>MyTimerTask</b> <b>extends TimerTask</b>{
    long time;
    
    public void run(){
      System.out.println("Display an Alert");

      try{
        //Select among two image files on the basis of
        // whether the current time in seconds is odd
        // or even.
        time = new Date().getTime()/1000 - baseTime;

        //Note that the following file names are case
        // sensitive.
        if((time % 2) == 0){//Even value
          image = Image.createImage(
                                  "/Alert01/redball.PNG");
        }else{//Odd value
          image = Image.createImage(
                                 "/Alert01/blueball.PNG");
        }//end else</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>Listing 6 begins by computing and saving the time in seconds that have 
elapsed since the MIDlet object was first constructed when the MIDlet was 
launched.</p>
<p><font color="#FF0000"><b>Select an image file based on even or odd time value</b></font></p>
<p>Then, depending on whether that time value is even or odd, the code in 
Listing 6 creates an <b>Image</b> object based on one or the other of two image 
files of type <b>PNG</b>.&nbsp; If the time is even, the <b>Image</b> is created 
from the data in the file named <b>redball.PNG</b>.&nbsp; Otherwise, the <b>
Image</b> is created from the data in the image file named <b>blueball.PNG</b>.&nbsp; 
It is important at this point to note that the file names used in the code are 
case sensitive and must match the actual file names.</p>
<p><font color="#FF0000">
<b>Create and program an Alert object</b></font></p>
<p>Listing 7 creates an <b>Alert</b> object of type <b>ALARM</b>.&nbsp; This 
alert type results in an audible alarm that sounds like an old-fashioned 
telephone ringing when the MIDlet is executed in the Sun cell phone emulator.</p>
<p>
<b><a name="Listing_7">Listing 7</a>. Create and program an Alert object in 
Alert01. </b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>        Alert alert = new Alert("Alert Title",
                                "",
                                image,
                                AlertType.ALARM);
                                
        //Cause the alert to display the time in seconds.
        alert.<b>setString</b>("Time in seconds:" + time);
        
        //Cause the alert to be visible for two seconds.
        alert.<b>setTimeout</b>(2000);</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>After creating the <b>Alert</b> object, Listing 7 calls the <b>setString</b> 
method 
to set the text value displayed by the <b>Alert</b> to include some text plus 
the elapsed time since the MIDlet was constructed.&nbsp; Thus, each time the <b>
Alert</b> becomes visible and the <b>run</b> method is executed, the time that 
is displayed is different.</p>
<p>Finally, Listing 7 calls the <b>setTimeout</b> method to establish the amount 
of time that the <b>Alert</b> will remain visible to 
2000 milliseconds or two seconds.</p>
<p><font color="#FF0000"><b>The visible/non-visible cycle</b></font></p>
<p>Referring back to Listing 3, the <b>Alert</b> will be made visible every 
three seconds following an initial visibility at two seconds.&nbsp; Referring to 
Listing 7, the <b>Alert</b> will remain visible for two seconds each time it is 
made visible.</p>
<p>The <b>TextBox</b> object should initially be visible for two seconds.&nbsp; 
Then there should be a repeating pattern of the <b>Alert</b> being visible for 
two seconds followed by the <b>TextBox</b> being visible for one second.</p>
<p>At the end of twenty seconds:</p>
<ul>
	<li>The thread containing the <b>startApp</b> method will wake up.</li>
	<li>The <b>Timer</b> will be cancelled</li>
	<li>The MIDlet will enter the destroyed state.</li>
</ul>
<p>If you run the MIDlet and watch closely, you should see time values of 2, 5, 
8, 11, 14, and 17 displayed by the text in the <b>Alert</b>.</p>
<p><font color="#FF0000">
<b>Create and service the Gauge</b></font></p>
<p>Listing 8 begins by creating a <b>Gauge</b> that shows six bars as shown in 
Figure 2.</p>
<p>
<b><a name="Listing_8">Listing 8</a>. Create and service the Gauge in Alert01. </b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>        Gauge gauge = new Gauge(null,false,6,0);
        
        //Set the number of Gauge bars to be illuminated.
        gauge.setValue(++count);
        
        //Attach the Gauge to the alert.
        alert.setIndicator(gauge);</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The variable named <b>count</b> is used to count the number of times that the
<b>run</b> method of the <b>TimerTask</b> object has been executed.&nbsp; Each 
time the method is executed, it increments the counter by one and calls the <b>
setValue</b> method on the <b>Gauge</b> to set the number of vertical bars that 
should be displayed in gray instead of white as shown in Figure 2.</p>
<p>Finally, Listing 8 calls the <b>setIndicator</b> method on the <b>Alert</b> 
object to attach the <b>Gauge</b> to the <b>Alert</b> object, producing the 
visual output shown in Figure 2.</p>
<p><font color="#FF0000">
<b>Make the Alert visible</b></font></p>
<p>Listing 9 calls the <b>setCurrent</b> method on the <b>Display</b> object <i>
(that represents the cell phone display)</i> to cause the <b>Alert</b> object to 
become the current <b>Displayable</b> object.&nbsp; This causes the <b>Alert</b> 
to be displayed on the cell phone screen.</p>
<p>
<b><a name="Listing_9">Listing 9</a>. Make the Alert visible in the MIDlet named 
Alert01. </b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>        Display.getDisplay(theMidlet).<b>setCurrent</b>(alert);
      }catch(Exception e){
        e.printStackTrace();
      }//end catch
    }//end run
  }//end class MyTimerTask
}//end class Alert01</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>Listing 9 also signals the end of the <b>run</b> method, the end of the 
member class named <b>MyTimerTask</b>, and the end of the MIDlet class named <b>
Alert01</b>.</p>
<h3><a name="The_MIDlet_named_Alert02">The MIDlet named Alert02</a></h3>
<p>As mentioned earlier, this MIDlet is very similar to the MIDlet named <b>
Alert01</b>.&nbsp; Therefore, I will confine my explanation to the code that is 
different between the two and the results imparted by those code differences.</p>
<p>The purpose of this MIDlet is to illustrate:</p>
<ul>
	<li>The use of an <b>Alert</b> user interface object.</li>
	<li>The use of image files in conjunction with the <b>Alert</b> object.</li>
	<li>The use of a <b>Timer</b> to schedule the <b>Alert</b> for repeatedly 
	becoming visible.</li>
	<li>The use of a non-interactive <b>Gauge</b> as an <i><b>activity meter</b></i>.</li>
</ul>
<p><font color="#FF0000"><b>A progress meter versus an activity meter</b></font></p>
<p>The big difference between the purpose of this MIDlet and the earlier MIDlet 
named <b>Alert01</b> is in the difference between a <i><b>progress meter</b></i> 
and an <i><b>activity meter</b></i>.&nbsp; Whereas a progress meter shows 
progress toward a known goal as in Figure 2, an activity meter simply shows that 
the MIDlet is active toward reaching an undefined goal as in Figure 3.</p>
<p><font color="#FF0000"><b>A CONFIRMATION alert</b></font></p>
<p>This MIDlet uses an alert of type <b>CONFIRMATION</b> whereas the MIDlet 
named <b>Alert01</b> uses an alert of type <b>ALARM</b>.&nbsp; When run in 
the Sun cell phone emulator, an alert type of type CONFIRMATION results in an 
audible alert consisting of a series of three chimes whereas an alert type ALARM 
results in the sound of an old-fashioned telephone ringing.</p>
<p><font color="#FF0000"><b>The GAUGE</b></font></p>
<p>For this MIDlet, a <b>Gauge</b> is displayed as:</p>
<p><b><font face="Arial Narrow">Gauge.INDEFINITE, Gauge.INCREMENTAL_UPDATING</font></b></p>
<p>This requires that a maximum value of three be passed to the <b>setValue</b> 
method because only three graphics are displayed and they need to repeat for 
values greater than three.&nbsp; A new graphic is displayed each time the alert 
becomes visible.&nbsp; The first graphic has Duke doing a cartwheel.&nbsp; The 
second graphic has Duke rendered in black, white, and red.&nbsp; The third 
graphic has Duke rendered in gray, white, and red as shown in Figure 3.</p>
<p><font color="#FF0000">
<b>Create an Alert object for the MIDlet named Alert02</b></font></p>
<p>The first major difference between the code in this MIDlet and the code in 
the earlier MIDlet named <b>Alert01</b> occurs in Listing 10.</p>
<p>
<b><a name="Listing_10">Listing 10</a>. Create an Alert object for the MIDlet 
named Alert02. </b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>        //Create an Alert object of type CONFIRMATION.
        // This results in an audible alert that is three
        // chimes.
        Alert alert = new Alert("Alert Title",
                                "",
                                image,
                                <b>AlertType.CONFIRMATION</b>);</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>As you can see in Listing 10, this MIDlet sets the alert type to <b>
CONFIRMATION</b>.&nbsp; This results in an audible alert produced by the Sun 
cell phone emulator being a series of three chimes.&nbsp; </p>
<p>Referring back to Listing 7, you can see that the alert type for the previous 
MIDlet was <b>ALARM</b>.&nbsp; This results in an audible alert produced by the 
Sun cell phone emulator that sounds like an old-fashioned telephone ringing.</p>
<p><font color="#FF0000">
<b>Create a Gauge for the MIDlet named Alert02</b></font></p>
<p>The next major difference in code between the two MIDlets is shown in Listing 
11.</p>
<p>
<b><a name="Listing_11">Listing 11</a>. Create a Gauge for the MIDlet named 
Alert02. </b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>        Gauge gauge = new Gauge(
                              null,
                              false,
                              <b>Gauge.INDEFINITE,
                              Gauge.INCREMENTAL_UPDATING</b>);</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>Whereas the previous MIDlet created a <b>Gauge</b> with a definite maximum 
value of 6 <i>(see Listing 8)</i>, this MIDlet creates a<b> Gauge</b> object 
with a maximum value of<b> INDEFINITE.</b>&nbsp; This makes it possible to 
specify one of the values in the earlier <a href="#one_of_four_states">list</a> 
for the final parameter.</p>
<p>The last two parameters passed to the constructor for the <b>Gauge</b> class 
in Figure 11 cause a <b>Gauge</b> to be constructed that shows three repeating images of Duke 
when the MIDlet is run in the Sun cell phone emulator. The first image has Duke doing a cartwheel.&nbsp; The second 
image has Duke in black, white, and red.&nbsp; The third image has Duke in gray, white, and 
red as shown in Figure 3.&nbsp; Then the sequence repeats.</p>
<p><font color="#FF0000">
<b>Set the current value of the Gauge to be count mod 3</b></font></p>
<p>The final difference in the code between the two MIDlets is shown in Listing 
12.&nbsp; Whereas the code in the <b>run</b> method in the earlier MIDlet simply 
set the current value of the <b>Gauge</b> to be the value of <b>count</b> <i>
(see Listing 8)</i>, Listing 12 sets the current value to be <b>count</b> <b>mod 
3</b>.&nbsp; This causes the current value to count from 0 to 2 and then repeat 
the sequence each time the value reaches 3.</p>
<p>
<b><a name="Listing_12">Listing 12</a>. Set the current value of the Gauge to be 
count mod 3. </b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>        gauge.setValue(++count % 3);</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>The remaining code in the MIDlet named <b>Alert02</b> is the same as the code 
in the MIDlet named <b>Alert01</b>.</p>
<center>
<h2><a name="Run the program"></a>Run the programs</h2>
</center>
<p>I encourage you to copy the code from Listing 13, Listing 14, and Listing 15. 
Run the two MIDlets in the updated MIDlet development framework named <b>
WTKFramework03</b> that is provided Listing 13.&nbsp; Experiment with the MIDlet 
code, making changes and running your modified MIDlets in the 
framework program.&nbsp; See if you can explain the results produced by your 
changes.</p>
<p>Don't forget that you will need to download and install the latest version of 
the Sun Java Wireless Toolkit for CLDC <i>(see <a href="#Resources">
Resources</a>)</i>.&nbsp; As of the date this lesson is being written, the latest version of the toolkit is WTK2.5.2.</p>
<p>You will also need two small image files.&nbsp; You can substitute any image files containing small images for the two image 
files listed <a href="#redball.PNG">above</a>.&nbsp; You will have to make the 
names of your image files match the references to the image files in the code <i>
(see Listing 6)</i>.</p>
<h2 align="center"><a name="Summary">Summary</a></h2>
<p>In this lesson you learned</p>
<ul>
	<li>How to program an <b>Alert</b> for a MIDlet.</li>
	<li>How to add an image to the <b>Alert</b>.</li>
	<li>How to add a <b>Gauge</b> to the <b>Alert</b> to act as a progress or 
	activity meter.</li>
	<li>How to use a <b>Timer</b> to control when an <b>Alert</b> becomes 
	visible on the screen.</li>
</ul>
<h2 align="center"><a name="Whats Next">What's next?</a></h2>
<p>In the next lesson, you will learn about the <b>Choice</b> interface and the
<b>List</b> class, which implements the <b>Choice</b> interface.&nbsp; You will learn 
about the composition of a <b>Choice</b> object.&nbsp; You will learn about 
implicit, exclusive, and multiple <b>Choice</b> types.&nbsp; You will learn about the 
selected state of a <b>Choice</b> element of each of the different types.&nbsp; 
Finally, you will learn how to create a <b>List</b>, how to display it in the 
Sun cell phone emulator, and how to determine which elements in the <b>List</b> 
are selected.</p>
<h2 align="center"><a name="Resources">Resources</a></h2>
<ul>
	<li><a href="http://java.sun.com/products/sjwtoolkit/download-2_5.html">
	Download</a> Sun Java Wireless Toolkit 2.5 for CLDC Release</li>
	<li><a href="http://en.wikipedia.org/wiki/MIDlet">MIDlet</a>: From 
	Wikipedia, the free encyclopedia</li>
	<li><a href="http://www.scmad.com/j2me-glossary1.php">MIDlet</a>: According 
	to SCMAD Certification Center</li>
	<li><a href="http://today.java.net/pub/a/today/2005/02/09/j2me1.html">J2ME 
	Tutorial, Part 1: Creating MIDlets</a> by Vikram Goyal</li>
	<li>
	<a href="http://today.java.net/pub/a/today/2005/02/09/j2me1.html?page=2#step4">
	Pre-verifying</a> MIDlet code according to Vikram Goyal</li>
	<li>
	<a href="http://today.java.net/pub/a/today/2005/02/09/j2me1.html?page=2#step7">
	Deploying</a> a MIDlet according to Vikram Goyal</li>
	<li><span class="style2">
	<a href="http://developers.sun.com/mobility/device/device;jsessionid=3F91C410E754F34B1A44DEBCE011ED18">
	The Java ME Device Table</a></span></li>
	<li><span class="style2">
	<a href="http://developers.sun.com/mobility/midp/ttips/getAppProperty/index.html">
	Retrieving MIDlet Attributes</a> by Richard Marejka</span></li>
	<li><a href="http://developers.sun.com/mobility/learn/midp/lifecycle/">
	Learning Path: MIDlet Life Cycle</a></li>
	<li><span class="style2">
	<a href="http://www.javaworld.com/javaworld/jw-12-2000/jw-1229-traps.html?page=1">
	When Runtime.exec() won't</a> By </span>Michael C. Daconta</li>
	<li>
	<a href="http://en.wikipedia.org/wiki/Connected_Limited_Device_Configuration">
	Connected Limited Device Configuration</a> <i>(CLDC)</i> from
	<span class="style2">Wikipedia</span></li>
	<li><span class="style2">
	<a href="http://en.wikipedia.org/wiki/Mobile_Information_Device_Profile">
	Mobile Information Device Profile</a> <i>(MIDP)</i> from Wikipedia</span></li>
	<li>Online API documentation for
	<a href="http://java.sun.com/javame/reference/apis/jsr030/">CLDC 1.0</a></li>
	<li>Online API documentation for
	<a href="http://java.sun.com/javame/reference/apis/jsr139/">CLDC 1.1</a></li>
	<li>Online API documentation for
	<a href="http://java.sun.com/javame/reference/apis/jsr037/">MIDP 1.0</a></li>
	<li>Online API documentation for
	<a href="http://java.sun.com/javame/reference/apis/jsr118/">MIDP 2.0</a></li>
	<li><a href="http://www.pictureresize.org/online-images-converter.html">Free 
	Online Image Converter</a></li>
	<li><a href="http://www.developer.com/java/j2me/article.php/3719111">2570</a> 
	Getting Started with MIDlets and the Sun Java Wireless Toolkit for CLDC</li>
	<li><a href="http://www.developer.com/java/j2me/article.php/3721706">2572</a> Capturing Output Produced by Programs Running in a Child Process</li>
	<li><a href="http://www.developer.com/java/j2me/article.php/3724381">2574</a> Back to Basics with MIDlets and the Sun Java Wireless Toolkit for 
	CLDC</li>
	<li><a href="http://www.developer.com/java/j2me/article.php/3727396">2576</a> Introduction to the MIDlet User Interface, Part 1</li>
	<li><a href="http://www.developer.com/java/j2me/article.php/3730141">2578</a> Introduction to the MIDlet User Interface, Part 2</li>
</ul>
<center>
<h2> <a name="Complete Program Listings"></a>Complete program listings</h2>
</center>
Complete listings of the programs discussed in this lesson are shown in Listing 
13, Listing 14, and Listing 15 below:<p>
<b><a name="Listing_13">Listing 13</a>. The updated MIDlet development framework named WTKFramework03. </b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>/*WTKFramework03.java
Copyright 2007, R.G.Baldwin

Updated: December 17, 2007

Version: WTKFramework03.java
Upgraded to prevent the deletion of image files and other 
resource files when the program cleans up after itself.
This results in resource files being included in the JAR 
file.  The resource files should be in the same directory 
as the source files.

Version: WTKFramework02.java
Upgraded to capture and display standard output and error
output from child processes.

Also upgraded to allow user to enter MIDlet name on the
command line.  This is particularly useful when repeatedly
running this program from a batch file during MIDlet
development.

Version: WTKFramework01.java
The purpose of this program is to provide a framework that
makes it easy to experiment with Java MIDlets written to
run on small mobile devices using the Sun Java Wireless
Toolkit (WTK2.5.2).  The framework not only makes such
experimentation easy, it also cleans up after itself by
automatically deleting all of the extraneous files created
during the development of the JAR and JAD files, which
are required for the deployment of the MIDlet program.

Given a file containing the source code for the MIDlet,
a single click of the mouse causes this framework to
automatically cycle through the following steps:

Compilation (targeted to Java v1.4 virtual machine)
Pre-verification
Creation of the manifest file
Creation of the JAR file
Creation of the JAD file
Deletion of extraneous files, saving the JAR and JAD files
Deployment and execution in Sun's cell phone emulator

The MIDlet being processed must be stored in a folder
having the same name as the main MIDlet class.  The
folder containing the MIDlet must be a child of the
folder in which the framework is being executed.

Note: When you transfer control to a new process window by
calling the exec method, the path environment variable
doesn't go along for the ride.  Therefore, you must
provide the full path for programs that you call in that
new process.

Tested using Java SE 6 and WTK2.5.2 running under
Windows XP.
*********************************************************/

import java.io.*;
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class WTKFramework03{
  String toolkit = "M:/WTK2.5.2";//Path to toolkit root
  String vendor = "Dick Baldwin";//Default vendor name
  String midletVersion = "1.0.0";
  String profile = "MIDP-2.0";
  String profileJar = "/lib/midpapi20.jar";
  String config = "CLDC-1.1";
  String configJar = "/lib/cldcapi11.jar";
  //Path to the bin folder of the Java installation
  String javaPath = "C:/Program Files/Java/jdk1.6.0/bin";
  String prog = "WTK001";

  int initialCleanupOK = 1;//Success = 0
  int compileOK = 1;//Compiler success = 0
  int preverifyOK = 1;//Preverify success = 0
  int deleteClassFilesOK = 1;//Delete success = 0
  int moveFilesOK = 1;//Move success = 0
  int manifestFileOK = 1;//Manifest success = 0
  int jarFileOK = 1;//Jar file success = 0
  int jadFileOK = 1;//Jad file success = 0
  int cleanupOK = 1;//Cleanup success = 0

  long jarFileSize = 0;

  JTextField progName;
  JTextField WTKroot;
  JTextField vendorText;
  JTextField midletVersionText;
  JTextField javaPathText;

  JRadioButton pButton10;
  JRadioButton pButton20;
  JRadioButton pButton21;

  JRadioButton cButton10;
  JRadioButton cButton11;

  static WTKFramework03 thisObj;
  //----------------------------------------------------//

  public static void main(String[] args){
    //Allow user to enter the MIDlet name on the command
    // line.  Useful when running from a batch file.
    thisObj = new WTKFramework03();
    if(args.length != 0)thisObj.prog = args[0];
    thisObj.new GUI();
  }//end main
  //----------------------------------------------------//

  void runTheProgram(){
    //This method is called when the user clicks the Run
    // button on the GUI.
    System.out.println("PROGRESS REPORT");
    System.out.println("Running program named: " + prog);

    //This code calls several methods in sequence to
    // accomplish the needed actions. If there is a
    // failure at any step along the way, the
    // framework will terminate at that point with a
    // suitable error message.

    //Delete leftover files from a previous run, if any
    // exist
    deleteOldStuff();
    if(initialCleanupOK != 0){//Test for success
      System.out.println("Initial cleanup error");
      System.out.println("Terminating");
      System.exit(1);
    }//end if

    compile();//compile the MIDlet
    if(compileOK != 0){//Test for successful compilation.
      System.out.println("Terminating");
      System.exit(1);
    }//end if

    preverify();//Pre-verify the MIDlet class files
    if(preverifyOK != 0){
      System.out.println("Terminating");
      System.exit(1);
    }//end if

    //Delete the class files from the original program
    // folder
    deleteClassFilesOK = deleteProgClassFiles();
    if(deleteClassFilesOK != 0){
      System.out.println("Terminating");
      System.exit(1);
    }//end if

    //Move the preverified files back to the original
    // program folder
    movePreverifiedFiles();
    if(moveFilesOK != 0){
      System.out.println("Terminating");
      System.exit(1);
    }//end if

    //Make manifest file
    makeManifestFile();
    if(manifestFileOK != 0){
      System.out.println("Manifest file error");
      System.out.println("Terminating");
      System.exit(1);
    }//end if

    //Make Jar file
    makeJarFile();
    if(jarFileOK != 0){
      System.out.println("JAR file error");
      System.out.println("Terminating");
      System.exit(1);
    }//end if

    //Make Jad file
    makeJadFile();
    if(jadFileOK != 0){
      System.out.println("Terminating");
      System.exit(1);
    }//end if

    //Delete extraneous files
    cleanup();
    if(cleanupOK != 0){
      System.out.println("Terminating");
      System.exit(1);
    }//end if

    //Run emulator
    runEmulator();

    //Reset success flags
    initialCleanupOK = 1;//Success = 0
    compileOK = 1;//Compiler success = 0
    preverifyOK = 1;//Preverify success = 0
    deleteClassFilesOK = 1;//Delete success = 0
    moveFilesOK = 1;//Move success = 0
    manifestFileOK = 1;//Manifest success = 0
    jarFileOK = 1;//Jar file success = 0
    jadFileOK = 1;//Jad file success = 0
    cleanupOK = 1;//Cleanup success = 0

    //Control returns to here when the user terminates
    // the cell phone emulator.
    System.out.println(
      "\nClick the Run button to run another MIDlet.");
    System.out.println();//blank line

  }//end runTheProgram
  //----------------------------------------------------//

  //Purpose: Delete leftover files at startup
  void deleteOldStuff(){
    System.out.println(
           "Deleting leftover files from a previous run");

    //Delete subdirectory from output folder if it exists.
    int successFlag = deleteOutputSubDir();

    //Delete manifest file if it exists.
    File manifestFile = new File("output/Manifest.mf");
    if(manifestFile.exists()){
      boolean success = manifestFile.delete();
      if(success){
        System.out.println("   Manifest file deleted");
      }else{
        successFlag = 1;
      }//end else
    }//end if

    //Delete old JAR file if it exists.
    File jarFile = new File("output/" + prog + ".jar");
    if(jarFile.exists()){
      boolean success = jarFile.delete();
      if(success){
        System.out.println("   Old jar file deleted");
      }else{
        successFlag = 1;
      }//end else
    }//end if

    //Delete old JAD file if it exists.
    File jadFile = new File("output/" + prog + ".jad");
    if(jadFile.exists()){
      boolean success = jadFile.delete();
      if(success){
        System.out.println("   Old jad file deleted");
      }else{
        successFlag = 1;
      }//end else
    }//end if

    //Delete class files from program folder, if any exist
    int temp = deleteProgClassFiles();
    if(temp != 0){
      successFlag = temp;
    }//end if

    if(successFlag == 0){
      System.out.println("\nLeftover files deleted");
      initialCleanupOK = 0;//success
    }else{
    }//end else

  }//end deleteOldStuff
  //----------------------------------------------------//

  //This method compiles the MIDlet.  Note that the
  // compilation generates class files for a Java v1.4
  // virtual machine.  Apparently WTK2.5.2 is not
  // compatible with Java 1.6.  Also note that the
  // compiler uses the classes in the WTK2.5.2 library
  // JAR files instead of using the classes in the
  // J2SE v1.6 libraries.
  void compile(){
    try{
      String cmdString =
           javaPath + "/javac -target 1.4 -source 1.4 "
           + "-bootclasspath " + toolkit + configJar + ";"
           + toolkit + profileJar
           + " " + prog + "/" + prog + ".java";

      System.out.println("\nCompile command:");
      System.out.println(cmdString);
      Process proc = Runtime.getRuntime().exec(cmdString);

      //Get and display the standard output and/or the
      // error output produced by the child process.
      getChildOutput(proc);

      //Delay until compilation is complete. Then test the
      // exit value of the compiler for success.  A value
      // of 0 indicates success.  Any other value
      // indicates that the compilation was not
      // successful.  Also note that this framework does
      // not display the compiler error messages.  If a
      // compilation fails, the next step is to use the
      // same approach from a batch file or from the
      // command line to perform the compilation on a
      // stand-alone basis.  That will expose the error
      // messages and allow for identifying and fixing the
      // problem in the MIDlet code.
      int val = proc.waitFor();
      compileOK = val;
      if(val == 0){
        System.out.println("Compile OK");
      }else{
        System.out.println("Compile error");
      }//end else

    }catch( Exception e ){
      e.printStackTrace();
    }//end catch

  }//end compile
  //----------------------------------------------------//

  //Purpose:  To preverify the class files.
  void preverify(){

    System.out.println(
        "\nPreverifying class files.");
    File dir = new File(prog);
    //Get a list of the files in the folder.
    String[] children = dir.list();
    for(int cnt = 0;cnt &lt; children.length;cnt++){
      //Only preverify files with an extension of .class
      String aFile = children[cnt];
      if(aFile.endsWith(".class")){
        //This is a class file
        try{
          //Remove the .class extension from the file name
          aFile = aFile.substring(0,aFile.lastIndexOf(
                                               ".class"));

          String cmdString =
                toolkit + "/bin/preverify.exe -classpath "
                + toolkit + configJar + ";"
                + toolkit + profileJar + " "
                + prog + "/" + aFile;

          System.out.println("\nPreverify command");
          System.out.println(cmdString);
          Process proc = Runtime.getRuntime().exec(
                                               cmdString);
          getChildOutput(proc);

          //Delay until preverification is complete
          int val = proc.waitFor();
          preverifyOK = val;
          if(val == 0){
            System.out.println("Pre-verify OK");
          }else{
            System.out.println("Pre-verify error");
            return;//return prematurely
          }//end else

        }catch( Exception e ){
          e.printStackTrace();
        }//end catch
      }//end if
    }//end for loop
  }//end preverify
  //----------------------------------------------------//

    //Purpose: Move preverified files back to original
    // program folder to make it easier to put them into
    // a JAR file with the correct path.
    void movePreverifiedFiles(){

    System.out.println(
         "\nMoving preverified files to program folder.");
    File dir = new File("output/" + prog);
    //Get a list of the files in the folder.
    String[] children = dir.list();

    //Destination directory
    File dest = new File(prog);

    for(int cnt = 0;cnt &lt; children.length;cnt++){
      String filename = children[cnt];

      try{
        // File to be moved
        String temp = "output/" + prog + "/" + filename;
        File file = new File(temp);

        // Move file to destination directory
        boolean success = file.renameTo(
                           new File(dest,file.getName()));
        if (!success){
          System.out.println("File move error");
          return;//return prematurely
        }else{
         System.out.println("   " + temp + " moved");
        }//end else

      }catch( Exception e ){
        e.printStackTrace();
      }//end catch
    }//end for loop

    moveFilesOK = 0;//Successful move
  }//end movePreverifiedFiles
  //----------------------------------------------------//

  void makeManifestFile(){
    try{
      BufferedWriter out = new BufferedWriter(
                    new FileWriter("output/Manifest.mf"));
      out.write("MIDlet-Name: " + prog + "\n");
      out.write(
               "MIDlet-Version: " + midletVersion + "\n");
      out.write("MIDlet-Vendor: " + vendor + "\n");
      out.close();
      System.out.println("\nManifest file written");
      manifestFileOK = 0;
    }catch( Exception e ){
      e.printStackTrace();
    }//end catch

  }//end makeManifestFile
  //----------------------------------------------------//

  void makeJarFile(){
    try{
      String cmdString =
                    javaPath + "/jar cvfm output/" + prog
                    + ".jar output/Manifest.mf ./" + prog;

      System.out.println("\nJAR command");
      System.out.println(cmdString);
      Process proc = Runtime.getRuntime().exec(cmdString);

      getChildOutput(proc);

      //Delay until complete
      int val = proc.waitFor();
      jarFileOK = val;
      if(val == 0){
        System.out.println("Jar file written");
      }else{
        System.out.println("Jar file error");
        return;//Return prematurely on error.
      }//end else

      //Get and save file size in bytes
      File file = new File("output/" + prog + ".jar");
      jarFileSize = file.length();
      System.out.println(
                     "   Jar file size = " + jarFileSize);

    }catch( Exception e ){
      e.printStackTrace();
    }//end catch

  }//end makeJarFile
  //----------------------------------------------------//

  void makeJadFile(){
    try{
      BufferedWriter out = new BufferedWriter(
               new FileWriter("output/" + prog + ".jad"));

      out.write("MIDlet-1: " + prog + ", , " + prog
                                + "." + prog + "" + "\n");

      out.write("MIDlet-Name: " + prog + "\n");
      out.write("MIDlet-Version: "
                                  + midletVersion + "\n");
      out.write("MIDlet-Vendor: " + vendor + "\n");
      out.write("MIDlet-Jar-URL: " + prog + ".jar\n");
      out.write("MIDlet-Jar-Size: " + jarFileSize + "\n");
      out.write("MicroEdition-Profile: "
                                        + profile + "\n");
      out.write("MicroEdition-Configuration: "
                                         + config + "\n");
      out.close();

      System.out.println("\nJad file written");
      jadFileOK = 0;
    }catch( Exception e ){
      e.printStackTrace();
    }//end catch
  }//end makeJadFile
  //----------------------------------------------------//

  //Purpose: To run Sun's cell phone emulator with this
  // MIDlet.
  void runEmulator(){
    try{
      String cmdString = toolkit + "/bin/emulator.exe "
                + "-Xdescriptor output/" + prog + ".jad";

      System.out.println("\nEmulator command");
      System.out.println(cmdString);
      Process proc = Runtime.getRuntime().exec(cmdString);

      getChildOutput(proc);

      //Delay until complete
      int val = proc.waitFor();
      if(val == 0){
        System.out.println("Emulator finished");
      }else{
        System.out.println("Emulator error");
      }//end else

    }catch( Exception e ){
      e.printStackTrace();
    }//end catch

  }//end runEmulator
  //----------------------------------------------------//

  //Purpose:  Delete all files and folders in the output
  // folder other than the jar and jad files. Also delete
  // all class files in the program folder.
  void cleanup(){
    //Delete subdirectory from output folder.
    int successFlag = deleteOutputSubDir();

    //Delete manifest file from output folder.
    File manifestFile = new File("output/Manifest.mf");
    if(manifestFile.exists()){
      boolean success = manifestFile.delete();
      if(success){
        System.out.println("   Manifest file deleted");
      }else{
        successFlag = 1;
      }//end else
    }//end if

    //Delete class files from program folder
    int temp = deleteProgClassFiles();
    if(temp != 0){
      successFlag = temp;
    }//end if

    if(successFlag == 0){
      System.out.println("\nExtraneous files deleted");
      cleanupOK = 0;//success
    }else{
    }//end else

  }//end cleanup
  //----------------------------------------------------//

  //Purpose: To delete the folder contained in the output
  // directory and all of its files.
  int deleteOutputSubDir(){
    int returnVal = 0;

    System.out.println(
                  "\nDeleting files from output folder.");
    //First delete the files in the subdirectory
    File subDir = new File("output/" + prog);
    //Get a list of the files in the folder.
    String[] children = subDir.list();
    if(children != null){
      for(int cnt = 0;cnt &lt; children.length;cnt++){

        boolean success = (new File("output/" + prog + "/"
                               + children[cnt])).delete();
        if(!success){
          // Deletion failed
          returnVal = 1;
        }else{
          System.out.println(
                      "   " + children[cnt] + " deleted");
        }//end else
      }//end for loop
    }//end if !null

    //Now delete the subdirectory
    if(subDir.exists()){
      boolean success = subDir.delete();
      if(!success){
        // Deletion failed
        returnVal = 1;
      }else{
        System.out.println("   Empty directory named "
                         + "output/" + prog + " deleted");
      }//end else
    }//end if

    return returnVal;
  }//end deleteOutputSubDir
  //----------------------------------------------------//

  //The purpose of this method is to delete the compiled
  // class files from the program folder.
  int deleteProgClassFiles(){
    int returnVal = 0;

    System.out.println(
        "\nDeleting class files from program folder.");
    File dir = new File(prog);
    //Get a list of the files in the folder.
    String[] children = dir.list();
    for(int cnt = 0;cnt &lt; children.length;cnt++){
      //Only delete files with an extension of .class
      String aFile = children[cnt];
      if(aFile.indexOf(".class") &gt;= 0 ){
        //This is a class file, delete it.
        boolean success = (
                   new File(prog + "/" + aFile).delete());
        if(!success){
          // Deletion failed
          returnVal = 1;
        }else{
          System.out.println("   " + aFile + " deleted");
        }//end else
      }else{
        //This is not a class file.
        System.out.println("   " + aFile + " saved");
      }//end else
      
    }//end for loop

    return returnVal;
  }//end deleteProgClassFiles
  //----------------------------------------------------//

  //Purpose: To get and display standard output and error
  // output from child processes.
  void getChildOutput(Process proc){
    try{
      //Connect an input stream to child's standard
      // output and child's error output.  Then
      // instantiate a thread to get and display each
      // type of output data from the child process.

      //Spawn two threads.
      ChildDataHandler errorHandler = 
                           new ChildDataHandler(
                           proc.getErrorStream(),"ERR: ");
      ChildDataHandler outputHandler = 
                           new ChildDataHandler(
                           proc.getInputStream(),"OUT: ");
          
      //Start them running
      errorHandler.start();
      outputHandler.start();

    }catch( Exception e ){
      e.printStackTrace();
    }//end catch
  }//end getChildOutput
  //====================================================//

  //This is an inner class that controls the interactive
  // behavior of the framework.
  class GUI extends JFrame{

    GUI(){//constructor
      setSize(400,250);
      setTitle("Copyright 2007, R.G.Baldwin");
      setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      JButton runButton = new JButton("Run");
      JPanel runPanel = new JPanel();
      runPanel.add(runButton);
      getContentPane().add(runPanel,"South");

      //Construct and populate fields for entry of text
      // data.
      JPanel textData = new JPanel();
      textData.setLayout(new GridLayout(0,2));
      getContentPane().add(textData,"North");

      //Populate first row of grid with default values.
      textData.add(new JLabel("  Program Name"));
      progName = new JTextField(prog);
      textData.add(progName);

      //Populate second row, etc.
      textData.add(new JLabel("  WTK Root"));
      WTKroot = new JTextField(toolkit);
      textData.add(WTKroot);

      //Populate third row ...
      textData.add(new JLabel("  Vendor"));
      vendorText = new JTextField(vendor);
      textData.add(vendorText);

      //Populate fourth row ...
      textData.add(new JLabel("  Midlet Version"));
      midletVersionText = new JTextField(midletVersion);
      textData.add(midletVersionText);

      //Populate fifth row
      textData.add(new JLabel(
                            "  Path to Java bin folder"));
      javaPathText = new JTextField(javaPath);
      textData.add(javaPathText);

      //Create column titles for profile and configuration
      // buttons
      textData.add(new JLabel(" "));//spacer
      textData.add(new JLabel(" "));//spacer
      textData.add(new JLabel("  Profile"));
      textData.add(new JLabel("  Configuration"));

      //Construct and populate radio buttons for
      // selection of profile and configuration.
      JPanel proCon = new JPanel();
      proCon.setLayout(new GridLayout(0,2));
      getContentPane().add(proCon,"Center");

      //Construct JPanel with radio buttons for selection
      // of profile.
      JPanel proButtons = new JPanel();
      proButtons.setLayout(new GridLayout(0,1));
      pButton10 = new JRadioButton("MIDP-1.0");
      pButton20 = new JRadioButton("MIDP-2.0",true);
      pButton21 = new JRadioButton("MIDP-2.1");

      //Make the buttons mutually exclusive.
      ButtonGroup profileGroup = new ButtonGroup();
      profileGroup.add(pButton10);
      profileGroup.add(pButton20);
      profileGroup.add(pButton21);

      //Add the radio buttons to the GUI
      proButtons.add(pButton10);
      proButtons.add(pButton20);
      proButtons.add(pButton21);
      proCon.add(proButtons);

      //Construct JPanel with radio buttons for selection
      // of configuration.
      JPanel configButtons = new JPanel();
      configButtons.setLayout(new GridLayout(0,1));
      cButton10 = new JRadioButton("CLDC-1.0");
      cButton11 = new JRadioButton("CLDC-1.1",true);

      //Make the buttons mutually exclusive.
      ButtonGroup configGroup = new ButtonGroup();
      configGroup.add(cButton10);
      configGroup.add(cButton11);

      //Add the radio buttons to the GUI
      configButtons.add(cButton10);
      configButtons.add(cButton11);
      proCon.add(configButtons);

      //Register an action listener on the Run button
      runButton.addActionListener(
        new ActionListener(){
          public void actionPerformed(ActionEvent e){
            //Get user inputs from text fields
            prog = progName.getText();
            toolkit = WTKroot.getText();
            vendor = vendorText.getText();
            midletVersion = midletVersionText.getText();
            javaPath = javaPathText.getText();

            //Set the profile based on which radio button
            // was selected by the user
            if(pButton10.isSelected()){
              profile = "MIDP-1.0";
              profileJar = "/lib/midpapi10.jar";
            }else if (pButton20.isSelected()){
              profile = "MIDP-2.0";
              profileJar = "/lib/midpapi20.jar";
            }else{//no other choice available
              profile = "MIDP-2.1";
              profileJar = "/lib/midpapi21.jar";
            }//end else

            //Set the configuration based on which radio
            // button was selected by the user
            if(cButton10.isSelected()){
              config = "CLDC-1.0";
              configJar = "/lib/cldcapi10.jar";
            }else{//no other choice available
              config = "CLDC-1.1";
              configJar = "/lib/cldcapi11.jar";
            }//end else

            //Now run the program.
            runTheProgram();

          }//end actionPerformed
        }//end new ActionListener
      );//end addActionListener

      setVisible(true);
    }//end constructor
  }//end class GUI
  //====================================================//
  
  //This is a member class.  Thanks to "When Runtime.
  // exec() won't" By Michael C. Daconta,JavaWorld.com
  // The purpose of an object of this class is to get and
  // display either the standard output or the error
  // output produced by a child process.
  class ChildDataHandler extends Thread{
    InputStream inputStream;
    String type;
    
    ChildDataHandler(InputStream inputStream,String type){
      this.inputStream = inputStream;
      this.type = type;
    }//end constructor
    
    public void run(){
      try{
        InputStreamReader inputStreamReader = 
                       new InputStreamReader(inputStream);
        BufferedReader bufferedReader = 
                    new BufferedReader(inputStreamReader);
        String line=null;
        while (
              (line = bufferedReader.readLine()) != null){
          System.out.println(type + line);
        }//end while
      }catch (Exception e){
        e.printStackTrace();  
      }//end catch
    }//end run
  }//end class ChildDataHandler  
  
  //====================================================//
}//end class WTKFramework03
//======================================================//</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>&nbsp;</p>
<p>
<b><a name="Listing_14">Listing 14</a>. Source code for the MIDlet named Alert01. </b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>/*Alert01.java
Copyright 2007, R.G.Baldwin

The purpose of this MIDlet is to illustrate:
a. The use of an Alert user interface object.
b. The use of image files in conjunction with the Alert.
c. The use of a Timer to schedule the Alert for 
   repeatedly becoming visible.
d. The use of a non-interactive Gauge as a progress
   meter.
   
Each time the Alert becomes visible, it obscures a 
TextBox object that is also being displayed.
   

This MIDlet requires:
a. The use of WTKFramework03
b. An image file named redball.PNG in the source code
   directory
c. An image file named blueball.PNG in the source code
   directory

Will work properly for .png, .gif, and .jpeg image
files so long as they are in the directory with the
source code. This restriction on location is imposed
by the framework program named WTKFramework03 and not
by MIDlet technology in general.

This version uses an alert of type ALARM. This results
in an audible alert that sounds like a telephone ringing.

Each time the alert becomes visible, it displays either
a red ball or a blue ball, depending on whether the time
in seconds is even or odd. A red ball is displayed for
even values of time.

A Gauge is displayed with a definite range of zero to six
bars.  A new bar is illuminated each time the alert 
becomes visible.

Tested using a Java SE 6 compiler, targeted at a V1.4
virtual machine, and WTK 2.5.2 running under Windows XP.
*********************************************************/

package Alert01;

import javax.microedition.lcdui.Display;
import javax.microedition.lcdui.Alert;
import javax.microedition.lcdui.AlertType;
import javax.microedition.lcdui.Gauge;
import javax.microedition.lcdui.Image;
import javax.microedition.lcdui.TextBox;
import javax.microedition.lcdui.TextField;
import javax.microedition.midlet.MIDlet;
import java.util.Timer;
import java.util.TimerTask;
import java.util.Date;

public class Alert01 extends MIDlet{

  Alert01 theMidlet;
  Image image;
  int count = 0;
  long baseTime;
  
  public Alert01(){
    System.out.println("Construct MIDlet");
    theMidlet = this;
    baseTime = new Date().getTime()/1000;
  }//end constructor
  //----------------------------------------------------//

  public void startApp(){
    System.out.println("Create and display a TextBox");

    TextBox textBox = new TextBox("TextBox Title",
                                  "TextBox contents",
                                  50,//width
                                  TextField.ANY);
                                  
    //Make the TextBox the current Displayable object.
    Display.getDisplay(this).setCurrent(textBox);
    
    //Now create and schedule a TimerTask that will 
    // display and sound an alert repeatedly. The Alert
    // first appears at two seconds and repeats every
    // three seconds.
    Timer myTimer = new Timer();
    myTimer.schedule(new MyTimerTask(),2000,3000);
  
    //Sleep for 20 seconds.
    try{Thread.currentThread().sleep(20000);
    } catch(Exception e){}
    
    //Cancel the timer.
    myTimer.cancel();

    //Enter the destroyed state.
    this.destroyApp(true);
  }//end startApp

  public void pauseApp(){
  }//end pauseApp

  public void destroyApp(boolean unconditional){
    System.out.println("Destroy MIDlet");
    notifyDestroyed();
  }//end destroyApp
  //----------------------------------------------------//
  
  //This is a member class
  class MyTimerTask extends TimerTask{
    long time;
    
    public void run(){
      System.out.println("Display an Alert");

      try{
        //Select among two image files on the basis of
        // whether the current time in seconds is odd
        // or even.
        time = new Date().getTime()/1000 - baseTime;

        //Note that the following file names are case
        // sensitive.
        if((time % 2) == 0){//Even value
          image = Image.createImage(
                                  "/Alert01/redball.PNG");
        }else{//Odd value
          image = Image.createImage(
                                 "/Alert01/blueball.PNG");
        }//end else

  
        //Create an Alert object of type ALARM. This 
        // results in an audible alarm that sounds like a
        // telephone ringing.
        Alert alert = new Alert("Alert Title",
                                "",
                                image,
                                AlertType.ALARM);
                                
        //Cause the alert to display the time in seconds.
        alert.setString("Time in seconds:" + time);
        
        //Cause the alert to be visible for two seconds.
        alert.setTimeout(2000);
        
        //Create a Gauge that shows six bars.
        Gauge gauge = new Gauge(null,false,6,0);
        
        //Set the number of Gauge bars to be illuminated.
        gauge.setValue(++count);
        
        //Attach the Gauge to the alert.
        alert.setIndicator(gauge);
    
        //Make the Alert the current Displayable object.
        Display.getDisplay(theMidlet).setCurrent(alert);
      }catch(Exception e){
        e.printStackTrace();
      }//end catch
    }//end run
  }//end class MyTimerTask
  //====================================================//
}//end class Alert01
//======================================================//</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>&nbsp;</p>
<p>
<b><a name="Listing_15">Listing 15</a>. Source code for the MIDlet named Alert02.
</b>
<table border="1" cols="1" width="477" bgcolor="#eeeeee">
  <tbody>
    <tr>
      <td>
      <pre>/*Alert02.java
Copyright 2007, R.G.Baldwin

The purpose of this MIDlet is to illustrate:
a. The use of an Alert user interface object.
b. The use of image files in conjunction with the Alert.
c. The use of a Timer to schedule the Alert for 
   repeatedly becoming visible.
d. The use of a non-interactive Gauge as a progress
   meter.
   
Each time the Alert becomes visible, it obscures a 
TextBox object that is also being displayed.
   

This MIDlet requires:
a. The use of WTKFramework03
b. An image file named redball.PNG in the source code
   directory
c. An image file named blueball.PNG in the source code
   directory

Will work properly for .png, .gif, and .jpeg image
files so long as they are in the directory with the
source code. This restriction on location is imposed
by the framework program named WTKFramework03 and not
by MIDlet technology in general.

This version uses an alert of type CONFIRMATION. This
results in an audible alert consisting of three chimes.

Each time the alert becomes visible, it displays either
a red ball or a blue ball, depending on whether the time
in seconds is even or odd. A red ball is displayed for
even values of time.

A Gauge is displayed as Gauge.INDEFINITE,
Gauge.INCREMENTAL_UPDATING.  This requires that a 
maximum value of three be passed to the setValue method
because only three graphics are displayed and they need
to repeat for values greater than three.  A new graphic
is displayed each time the alert becomes visible.

Tested using a Java SE 6 compiler, targeted at a V1.4
virtual machine, and WTK 2.5.2 running under Windows XP.
*********************************************************/

package Alert02;

import javax.microedition.lcdui.Display;
import javax.microedition.lcdui.Alert;
import javax.microedition.lcdui.AlertType;
import javax.microedition.lcdui.Gauge;
import javax.microedition.lcdui.Image;
import javax.microedition.lcdui.TextBox;
import javax.microedition.lcdui.TextField;
import javax.microedition.midlet.MIDlet;
import java.util.Timer;
import java.util.TimerTask;
import java.util.Date;

public class Alert02 extends MIDlet{

  Alert02 theMidlet;
  Image image;
  int count = 0;
  long baseTime;
  
  public Alert02(){
    System.out.println("Construct MIDlet");
    theMidlet = this;
    baseTime = new Date().getTime()/1000;
  }//end constructor
  //----------------------------------------------------//

  public void startApp(){
    System.out.println("Create and display a TextBox");

    TextBox textBox = new TextBox("TextBox Title",
                                  "TextBox contents",
                                  50,//width
                                  TextField.ANY);
                                  
    //Make the TextBox the current Displayable object.
    Display.getDisplay(this).setCurrent(textBox);
    
    //Now create and schedule a TimerTask that will 
    // display and sound an alert repeatedly, The Alert
    // first appears at two seconds and repeats every
    // three seconds.
    Timer myTimer = new Timer();
    myTimer.schedule(new MyTimerTask(),2000,3000);
  
    //Sleep for 20 seconds.
    try{Thread.currentThread().sleep(20000);
    } catch(Exception e){}
    
    //Cancel the timer.
    myTimer.cancel();

    //Enter the destroyed state.
    this.destroyApp(true);
  }//end startApp

  public void pauseApp(){
  }//end pauseApp

  public void destroyApp(boolean unconditional){
    System.out.println("Destroy MIDlet");
    notifyDestroyed();
  }//end destroyApp
  //----------------------------------------------------//
  
  //This is a member class
  class MyTimerTask extends TimerTask{
    long time;
    
    public void run(){
      System.out.println("Display an Alert");

      try{
        //Select among two image files on the basis of
        // whether the current time in seconds is odd
        // or even.
        time = new Date().getTime()/1000 - baseTime;

        //Note that the following file names are case
        // sensitive.
        if((time % 2) == 0){//Even value
          image = Image.createImage(
                                  "/Alert02/redball.PNG");
        }else{//Odd value
          image = Image.createImage(
                                 "/Alert02/blueball.PNG");
        }//end else
  
        //Create an Alert object of type CONFIRMATION.
        // This results in an audible alert that is three
        // chimes.
        Alert alert = new Alert("Alert Title",
                                "",
                                image,
                                AlertType.CONFIRMATION);

        //Cause the alert to display the time in seconds.
        alert.setString("Time in seconds:" + time);

        //Cause the alert to be visible for two seconds.
        alert.setTimeout(2000);
        
        //Create a Gauge that shows three repeating images
        // of Duke. The first has Duke doing a cartwheel.
        // The second has Duke in black, white, and red.
        // The third has Duke in gray, white, and red.
        Gauge gauge = new Gauge(
                              null,
                              false,
                              Gauge.INDEFINITE,
                              Gauge.INCREMENTAL_UPDATING);
        
        //Set the number of Gauge graphics to be
        // displayed. The limit for INCREMENTAL_UPDATING
        // is 3.
        gauge.setValue(++count % 3);
        //Attach the Gauge to the alert.
        alert.setIndicator(gauge);
    
        //Make the Alert the current Displayable object.
        Display.getDisplay(theMidlet).setCurrent(alert);
      }catch(Exception e){
        e.printStackTrace();
      }//end catch
    }//end run
  }//end class MyTimerTask
  //====================================================//
}//end class Alert02
//======================================================//</pre>
      </td>
    </tr>
  </tbody>
</table>
</p>
<p>&nbsp;</p>

<p> </p>
<hr align="center" size="3" width="100%">
<h2 align="center"><a name="Copyright">Copyright</a></h2>
<p>Copyright 2008, Richard G. Baldwin.&nbsp; Reproduction in whole or in part in any 
form or medium without express written permission from Richard Baldwin is 
prohibited. </p>
<h2 align="center"><a name="About_the_author">About the author</a></h2>
<b><a href="mailto:Baldwin@DickBaldwin.com">Richard Baldwin</a></b><i> is a 
college professor (at Austin Community College in Austin, TX) and private 
consultant whose primary focus is a combination of Java, C#, and XML. In 
addition to the many platform and/or language independent benefits of Java and 
C# applications, he believes that a combination of Java, C#, and XML will become 
the primary driving force in the delivery of structured information on the Web.</i>    
<p><i>Richard has participated in numerous consulting projects and he 
frequently provides onsite training at the high-tech companies located in and 
around Austin, Texas.&nbsp; He is the author of Baldwin's Programming
<a href="http://www.dickbaldwin.com">Tutorials</a>, which have gained a 
worldwide following among experienced and aspiring programmers. He has also 
published articles in JavaPro magazine.</i> </p>
<p><i>In addition to his programming expertise, Richard has many years of 
practical experience in Digital Signal Processing (DSP).&nbsp; His first job after he 
earned his Bachelor's degree was doing DSP in the Seismic Research Department of 
Texas Instruments.&nbsp; (TI is still a world leader in DSP.)&nbsp; In the following 
years, he applied his programming and DSP expertise to other interesting areas 
including sonar and underwater acoustics.</i> </p>
<p><i>Richard holds an MSEE degree from Southern Methodist University and has 
many years of experience in the application of computer technology to real-world 
problems.</i> </p>
<p><i><a href="mailto:baldwin@dickbaldwin.com">Baldwin@DickBaldwin.com</a></i>
</p>
<p><b>Keywords</b><br>
java J2ME MIDlet &quot;cell phone emulator&quot; &quot;wireless toolkit&quot; WTK MIDP CLDC 
Displayable TextBox Ticker TextField Alerts Images Timers Gauges</p>
<p>-end- </p>
</body>
</html>
